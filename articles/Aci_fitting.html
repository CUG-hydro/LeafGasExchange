<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aci_fitting • LeafGasExchange</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Aci_fitting">
<meta property="og:description" content="LeafGasExchange">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LeafGasExchange</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Aci_fitting.html">Aci_fitting</a>
    </li>
    <li>
      <a href="../articles/Aq_fitting.html">Aq_fitting</a>
    </li>
    <li>
      <a href="../articles/Canopy_scaling.html">Canopy_scaling</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_conductance.html">Guide to use the LeagGasExchange package to simulate leaf conductance</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_photosynthesis.html">Guide to use the LeafGasExchange package to simulate the photosynthesis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Aci_fitting</h1>
                        <h4 data-toc-skip class="author">Julien
LAMOUR</h4>
            
            <h4 data-toc-skip class="date">04/20/2023</h4>
      
      
      <div class="hidden name"><code>Aci_fitting.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="load-the-r-libraries">Load the R libraries<a class="anchor" aria-label="anchor" href="#load-the-r-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">LeafGasExchange</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-an-aci-curve">Fitting an Aci curve<a class="anchor" aria-label="anchor" href="#fitting-an-aci-curve"></a>
</h2>
<p>The objective of this tutorial is to illustrate how to fit an A-Ci
curve using the “LeafGasExchange” package. In this tutorial, we first
simulate an A-Ci curve with known photosynthetic parameters and noise.
This curve is then fitted to retrieve the parameters.</p>
<div class="section level3">
<h3 id="simulating-an-aci-curve">Simulating an Aci curve<a class="anchor" aria-label="anchor" href="#simulating-an-aci-curve"></a>
</h3>
<p>For this example we first simulate a photosynthesis curve, but it
would work the same if the data were not simulated but measured. The
data simulation is done using the function f.A. This function needs a
list of photosynthetic parameters which are produced using the function
f.make.param() and a list of input variables (CO2 at the surface of the
leaf, leaf temperature, incident light, RH). To have more information on
the function f.make.param, you can use the command ?f.make.param in R
console.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param</span><span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>VcmaxRef <span class="op">=</span> <span class="fl">50</span>,JmaxRef<span class="op">=</span><span class="fl">50</span><span class="op">*</span><span class="fl">1.7</span>,TpRef<span class="op">=</span><span class="fl">50</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">CO2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">1500</span>,<span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">Tleaf</span><span class="op">=</span><span class="fl">30</span><span class="op">+</span><span class="fl">273.16</span></span>
<span><span class="va">Tair</span><span class="op">=</span><span class="fl">27</span><span class="op">+</span><span class="fl">273.16</span></span>
<span><span class="va">PAR</span><span class="op">=</span><span class="fl">1800</span></span>
<span><span class="va">RH</span><span class="op">=</span><span class="fl">80</span></span>
<span><span class="va">simul</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">PAR</span>,cs <span class="op">=</span> <span class="va">CO2</span>,Tleaf <span class="op">=</span> <span class="va">Tleaf</span>,Tair <span class="op">=</span> <span class="va">Tair</span>,RH <span class="op">=</span> <span class="va">RH</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Here we include a normal error </span></span>
<span></span>
<span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">=</span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>,mean <span class="op">=</span> <span class="fl">0</span>,sd <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">measures</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Tleaf<span class="op">=</span><span class="va">Tleaf</span>,Ci<span class="op">=</span><span class="va">simul</span><span class="op">$</span><span class="va">ci</span>,Qin<span class="op">=</span><span class="va">PAR</span>,A<span class="op">=</span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">)</span></span></code></pre></div>
<p>We display this simulated curve using the function f.plot</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/f.plot.html">f.plot</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures</span>,type <span class="op">=</span> <span class="st">'Aci'</span>,list_legend <span class="op">=</span> <span class="va">param</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'VcmaxRef'</span>,<span class="st">'JmaxRef'</span>,<span class="st">'TpRef'</span>,<span class="st">'RdRef'</span><span class="op">)</span><span class="op">]</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span></code></pre></div>
<p><img src="Aci_fitting_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="fitting-an-aci-curve-1">Fitting an Aci curve<a class="anchor" aria-label="anchor" href="#fitting-an-aci-curve-1"></a>
</h3>
<p>To fit an Aci curve, it is necessary to detail the parameter that we
want to estimate. All the parameters present in f.make.param can
potentially be fitted even if it would not always make sense. We do a
first fitting with only the parameters VcmaxRef, JmaxRef and RdRef.
Those parameters have to be given in the list Start, with initial
values. The method will look for different initial values around those
values so it is not necessary to give very good ones, just not too
stupid ones. The photosynthetic parameters have to be given in the list
param. This is used to determine what should be the parameters for the
temperature dependence, for the leaf absorbance, theta, etc. By default,
the equations and parameters used in the TBM FATES to simulate the
photosynthesis are used. In this example, we also give a very high value
to TpRef so the TPU limitation is not considered when fitting the
curve.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitting1</span><span class="op">=</span><span class="fu"><a href="../reference/f.fitting.html">f.fitting</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures</span>,Start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>JmaxRef <span class="op">=</span> <span class="fl">30</span>, VcmaxRef <span class="op">=</span> <span class="fl">50</span>, RdRef <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,param<span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   modify.init<span class="op">=</span><span class="cn">TRUE</span>,do.plot<span class="op">=</span><span class="cn">TRUE</span>,type<span class="op">=</span><span class="st">'Aci'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $par</span></span>
<span><span class="co">##    JmaxRef   VcmaxRef      RdRef </span></span>
<span><span class="co">## 77.0202708 47.9096669  0.8837133 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $value</span></span>
<span><span class="co">## [1] 16.89123</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">## function gradient </span></span>
<span><span class="co">##      214       NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $convergence</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $message</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [1] "sd 0.750360470933128"</span></span>
<span><span class="co">## Length  Class   Mode </span></span>
<span><span class="co">##      1   mle2     S4</span></span></code></pre>
<p><img src="Aci_fitting_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>In a second example we now also fit TpRef</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitting2</span><span class="op">=</span><span class="fu"><a href="../reference/f.fitting.html">f.fitting</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures</span>,Start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>JmaxRef <span class="op">=</span> <span class="fl">30</span>, VcmaxRef <span class="op">=</span> <span class="fl">50</span>, RdRef <span class="op">=</span> <span class="fl">1</span>, TpRef<span class="op">=</span><span class="fl">9</span><span class="op">)</span>,param<span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   modify.init<span class="op">=</span><span class="cn">TRUE</span>,do.plot<span class="op">=</span><span class="cn">TRUE</span>,type<span class="op">=</span><span class="st">'Aci'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $par</span></span>
<span><span class="co">##   JmaxRef  VcmaxRef     RdRef     TpRef </span></span>
<span><span class="co">## 82.947930 49.612135  1.168832  4.913234 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $value</span></span>
<span><span class="co">## [1] 11.28015</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">## function gradient </span></span>
<span><span class="co">##      407       NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $convergence</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $message</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [1] "sd 0.613192484693365"</span></span>
<span><span class="co">## Length  Class   Mode </span></span>
<span><span class="co">##      1   mle2     S4</span></span></code></pre>
<p><img src="Aci_fitting_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The fitting returns a list of 3 objects. The first object corresponds
to the fitting using a minimum square function whereas the second object
corresponds to a maximum likelihood derived using the mle2 package. This
latter method is useful because it allows us to calculate the confidence
interval of the parameters.</p>
<p>The third object correspond to the mean environmental values present
in the input data file of the function (see the help of f.fitting for
more info).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               2.5 %     97.5 %</span></span>
<span><span class="co">## sigma     0.4857392  0.8083757</span></span>
<span><span class="co">## JmaxRef  77.4773088 89.2158930</span></span>
<span><span class="co">## VcmaxRef 45.1100901 54.9294156</span></span>
<span><span class="co">## TpRef     4.6493722  5.1903012</span></span>
<span><span class="co">## RdRef     0.4440687  1.9172811</span></span></code></pre>
<p>It is possible to compare the AIC of the two models using the base
function AIC. The lower AIC corresponds to the best model, showing that
in this case and as expected, the TPU limitation is useful to improve
the fit of the model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitting1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 75.90422</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 65.79171</span></span></code></pre>
<p>It is also possible to calculate the interval of confidence and
prediction of the Aci curve from the outputs of the fitting.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_cov</span><span class="op">=</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">vcov</span></span>
<span><span class="va">random_param</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">1000</span>,mean<span class="op">=</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sigma'</span>,<span class="st">'JmaxRef'</span>,<span class="st">'VcmaxRef'</span>,<span class="st">'TpRef'</span>,<span class="st">'RdRef'</span><span class="op">)</span><span class="op">]</span>,sigma <span class="op">=</span> <span class="va">var_cov</span><span class="op">)</span></span>
<span></span>
<span><span class="va">random_simul</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>,nrow <span class="op">=</span> <span class="fl">1000</span>,ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">measures</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">random_simul</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="../reference/f.Aci.html">f.Aci</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">measures</span><span class="op">$</span><span class="va">Qin</span>,ci <span class="op">=</span> <span class="va">measures</span><span class="op">$</span><span class="va">Ci</span>,Tleaf <span class="op">=</span><span class="va">measures</span><span class="op">$</span><span class="va">Tleaf</span>,param <span class="op">=</span> <span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>VcmaxRef<span class="op">=</span><span class="va">random_param</span><span class="op">[</span><span class="va">i</span>,<span class="st">'VcmaxRef'</span><span class="op">]</span>,JmaxRef<span class="op">=</span><span class="va">random_param</span><span class="op">[</span><span class="va">i</span>,<span class="st">'JmaxRef'</span><span class="op">]</span>,TpRef<span class="op">=</span><span class="va">random_param</span><span class="op">[</span><span class="va">i</span>,<span class="st">'TpRef'</span><span class="op">]</span>,</span>
<span>                                                                                                         RdRef<span class="op">=</span><span class="va">random_param</span><span class="op">[</span><span class="va">i</span>,<span class="st">'RdRef'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">A</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fit_pred</span><span class="op">=</span><span class="fu"><a href="../reference/f.Aci.html">f.Aci</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">measures</span><span class="op">$</span><span class="va">Qin</span>,ci <span class="op">=</span> <span class="va">measures</span><span class="op">$</span><span class="va">Ci</span>,Tleaf <span class="op">=</span><span class="va">measures</span><span class="op">$</span><span class="va">Tleaf</span>,param <span class="op">=</span> <span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>VcmaxRef<span class="op">=</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'VcmaxRef'</span><span class="op">)</span><span class="op">]</span>,JmaxRef<span class="op">=</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'JmaxRef'</span><span class="op">)</span><span class="op">]</span>,TpRef<span class="op">=</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TpRef'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                                                                               RdRef<span class="op">=</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coef</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'RdRef'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sd_mean</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">random_simul</span>,MARGIN<span class="op">=</span><span class="fl">2</span>,FUN<span class="op">=</span><span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">sd_res</span><span class="op">=</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">coef</span><span class="op">[</span><span class="st">'sigma'</span><span class="op">]</span></span>
<span><span class="va">sd_tot</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sd_mean</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">sd_res</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">simul_confint</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">fit_pred</span><span class="op">$</span><span class="va">A</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">sd_mean</span>,<span class="va">fit_pred</span><span class="op">$</span><span class="va">A</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">sd_mean</span><span class="op">)</span></span>
<span><span class="va">simul_pred</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">fit_pred</span><span class="op">$</span><span class="va">A</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">sd_tot</span>,<span class="va">fit_pred</span><span class="op">$</span><span class="va">A</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">sd_tot</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/f.plot.html">f.plot</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures</span>,type <span class="op">=</span> <span class="st">'Aci'</span>,list_legend <span class="op">=</span> <span class="va">param</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'VcmaxRef'</span>,<span class="st">'JmaxRef'</span>,<span class="st">'TpRef'</span>,<span class="st">'RdRef'</span><span class="op">)</span><span class="op">]</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">measures</span><span class="op">$</span><span class="va">Ci</span> ,<span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">measures</span><span class="op">$</span><span class="va">Ci</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">simul_pred</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">simul_pred</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"lightgrey"</span>,alpha.f<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">measures</span><span class="op">$</span><span class="va">Ci</span> ,<span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">measures</span><span class="op">$</span><span class="va">Ci</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">simul_confint</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">simul_confint</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"#99CC99"</span>,alpha.f<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="Aci_fitting_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julien Lamour.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
