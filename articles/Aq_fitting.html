<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aq_fitting • LeafGasExchange</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Aq_fitting">
<meta property="og:description" content="LeafGasExchange">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LeafGasExchange</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Aci_fitting.html">Aci_fitting</a>
    </li>
    <li>
      <a href="../articles/Aq_fitting.html">Aq_fitting</a>
    </li>
    <li>
      <a href="../articles/Canopy_scaling.html">Canopy_scaling</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_conductance.html">Guide to use the LeagGasExchange package to simulate leaf conductance</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_photosynthesis.html">Guide to use the LeafGasExchange package to simulate the photosynthesis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Aq_fitting</h1>
                        <h4 data-toc-skip class="author">Julien
LAMOUR</h4>
            
            <h4 data-toc-skip class="date">04/20/2023</h4>
      
      
      <div class="hidden name"><code>Aq_fitting.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="load-the-r-libraries">Load the R libraries<a class="anchor" aria-label="anchor" href="#load-the-r-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">LeafGasExchange</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-an-aq-curve">Fitting an AQ curve<a class="anchor" aria-label="anchor" href="#fitting-an-aq-curve"></a>
</h2>
<p>The objective of this tutorial is to illustrate how to fit an A-Q
curve using the “LeafGasExchange” package. In this tutorial, we first
simulate an A-Q curve with known photosynthetic parameters and noise.
This curve is then fitted to retrieve the parameters.</p>
<div class="section level3">
<h3 id="simulating-an-aq-curve">Simulating an AQ curve<a class="anchor" aria-label="anchor" href="#simulating-an-aq-curve"></a>
</h3>
<p>For this example we first simulate a photosynthesis curve, but it
would work the same if the data was not simulated but measured. The data
simulation is done using the function f.A. This function needs a list of
photosynthetic parameters which are produced using the function
f.make.param() and a list of input variables (CO2 at the surface of the
leaf, leaf temperature, incident light, RH). To have more information on
the function f.make.param, you can use the command ?f.make.param in R
console. Theta corresponds to the empirical curvature factor and abso
corresponds to the leaf absorptance.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param</span><span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>VcmaxRef <span class="op">=</span> <span class="fl">70</span>,JmaxRef<span class="op">=</span><span class="fl">90</span>,Theta<span class="op">=</span><span class="fl">0.7</span>,abso<span class="op">=</span><span class="fl">0.9</span>,TpRef<span class="op">=</span><span class="fl">50</span><span class="op">/</span><span class="fl">10</span>,RdRef<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">CO2</span><span class="op">=</span><span class="fl">400</span></span>
<span><span class="va">Tleaf</span><span class="op">=</span><span class="fl">30</span><span class="op">+</span><span class="fl">273.16</span></span>
<span><span class="va">Tair</span><span class="op">=</span><span class="fl">27</span><span class="op">+</span><span class="fl">273.16</span></span>
<span><span class="va">PAR</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span>,<span class="fl">50</span>,<span class="fl">80</span>,<span class="fl">120</span>,<span class="fl">200</span>,<span class="fl">400</span>,<span class="fl">600</span>,<span class="fl">800</span>,<span class="fl">1000</span>,<span class="fl">1200</span>,<span class="fl">1400</span>,<span class="fl">1600</span>,<span class="fl">1800</span>,<span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">RH</span><span class="op">=</span><span class="fl">70</span></span>
<span><span class="va">simul</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">PAR</span>,cs <span class="op">=</span> <span class="va">CO2</span>,Tleaf <span class="op">=</span> <span class="va">Tleaf</span>,Tair <span class="op">=</span> <span class="va">Tair</span>,RH <span class="op">=</span> <span class="va">RH</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Here we include a normal error </span></span>
<span></span>
<span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">=</span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>,mean <span class="op">=</span> <span class="fl">0</span>,sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">measures</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Tleaf<span class="op">=</span><span class="va">Tleaf</span>,Ci<span class="op">=</span><span class="va">simul</span><span class="op">$</span><span class="va">ci</span>,Qin<span class="op">=</span><span class="va">PAR</span>,A<span class="op">=</span><span class="va">simul</span><span class="op">$</span><span class="va">A</span><span class="op">)</span></span></code></pre></div>
<p>We display this simulated curve using the function f.plot</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/f.plot.html">f.plot</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures</span>,type <span class="op">=</span> <span class="st">'Aq'</span>,list_legend <span class="op">=</span> <span class="va">param</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'VcmaxRef'</span>,<span class="st">'JmaxRef'</span>,<span class="st">'TpRef'</span>,<span class="st">'RdRef'</span>,<span class="st">'Theta'</span><span class="op">)</span><span class="op">]</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span></code></pre></div>
<p><img src="Aq_fitting_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>In this case, you see that the top Assimilation values are only
limited by Aj. It is thought that at high light in usual environmental
conditions, Ac and Aj have similar rates. This coordination is thought
to be often present in plants. In other cases Ac can be limiting at high
light.</p>
<p>For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param2</span><span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>VcmaxRef <span class="op">=</span> <span class="fl">55</span>,JmaxRef<span class="op">=</span><span class="fl">90</span>,Theta<span class="op">=</span><span class="fl">0.7</span>,abso<span class="op">=</span><span class="fl">0.9</span>,TpRef<span class="op">=</span><span class="fl">5</span>,RdRef<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">simul2</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">PAR</span>,cs <span class="op">=</span> <span class="va">CO2</span>,Tleaf <span class="op">=</span> <span class="va">Tleaf</span>,Tair <span class="op">=</span> <span class="va">Tair</span>,RH <span class="op">=</span> <span class="va">RH</span>,param <span class="op">=</span> <span class="va">param2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Here we include a normal error </span></span>
<span></span>
<span><span class="va">simul2</span><span class="op">$</span><span class="va">A</span><span class="op">=</span><span class="va">simul2</span><span class="op">$</span><span class="va">A</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">simul2</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>,mean <span class="op">=</span> <span class="fl">0</span>,sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">measures2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Tleaf<span class="op">=</span><span class="va">Tleaf</span>,Ci<span class="op">=</span><span class="va">simul2</span><span class="op">$</span><span class="va">ci</span>,Qin<span class="op">=</span><span class="va">PAR</span>,A<span class="op">=</span><span class="va">simul2</span><span class="op">$</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/f.plot.html">f.plot</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures2</span>,type <span class="op">=</span> <span class="st">'Aq'</span>,list_legend <span class="op">=</span> <span class="va">param2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'VcmaxRef'</span>,<span class="st">'JmaxRef'</span>,<span class="st">'TpRef'</span>,<span class="st">'RdRef'</span>,<span class="st">'Theta'</span><span class="op">)</span><span class="op">]</span>,param <span class="op">=</span> <span class="va">param2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Aq_fitting_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="fitting-an-aq-curve-1">Fitting an AQ curve<a class="anchor" aria-label="anchor" href="#fitting-an-aq-curve-1"></a>
</h3>
<p>To fit an AQ curve, it is necessary to detail the parameter that we
want to estimate. All the parameters present in f.make.param can
potentially be fitted even if it would not always make sense. We do a
first fitting with only the parameters JmaxRef, Theta and RdRef. Those
parameters have to be given in the list Start, with initial values. The
method will look for different initial values around those values so it
is not necessary to give very good ones, just not too stupid ones. The
photosynthetic parameters have to be given in the list param. This is
used to determine what should be the parameters for the temperature
dependence, for the leaf absorbance, theta, etc. By default, the
equations and parameters used in the TBM FATES to simulate the
photosynthesis are used. In this example, we also give a high value for
VcmaxRef so it is not limiting the photosynthesis rates. We’ll revisit
this assumption later.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitting1</span><span class="op">=</span><span class="fu"><a href="../reference/f.fitting.html">f.fitting</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures</span>,Start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>JmaxRef <span class="op">=</span> <span class="fl">60</span>, RdRef <span class="op">=</span> <span class="fl">1</span>,Theta<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,param<span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>abso<span class="op">=</span><span class="fl">0.9</span>,VcmaxRef<span class="op">=</span><span class="fl">9999</span><span class="op">)</span>,</span>
<span>                   modify.init<span class="op">=</span><span class="cn">TRUE</span>,do.plot<span class="op">=</span><span class="cn">TRUE</span>,type<span class="op">=</span><span class="st">'Aq'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $par</span></span>
<span><span class="co">##    JmaxRef      RdRef      Theta </span></span>
<span><span class="co">## 91.1058040  1.0993250  0.6656334 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $value</span></span>
<span><span class="co">## [1] 0.356863</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">## function gradient </span></span>
<span><span class="co">##      120       NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $convergence</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $message</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [1] "sd 0.15424288223646"</span></span>
<span><span class="co">## Length  Class   Mode </span></span>
<span><span class="co">##      1   mle2     S4</span></span></code></pre>
<p><img src="Aq_fitting_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>In a second example we now also (try to) fit VcmaxRef. Here the
fitting gives a weird value for VcmaxRef which is very high as there is
no information in the curve to estimate it.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitting2</span><span class="op">=</span><span class="fu"><a href="../reference/f.fitting.html">f.fitting</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures</span>,Start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>JmaxRef <span class="op">=</span> <span class="fl">30</span>,VcmaxRef<span class="op">=</span><span class="fl">40</span>, RdRef <span class="op">=</span> <span class="fl">1</span>,Theta<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,param<span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>abso<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                   modify.init<span class="op">=</span><span class="cn">TRUE</span>,do.plot<span class="op">=</span><span class="cn">TRUE</span>,type<span class="op">=</span><span class="st">'Aq'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $par</span></span>
<span><span class="co">##     JmaxRef    VcmaxRef       RdRef       Theta </span></span>
<span><span class="co">##  91.1472544 223.2039836   1.0999653   0.6656598 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $value</span></span>
<span><span class="co">## [1] 0.3569293</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">## function gradient </span></span>
<span><span class="co">##      501       NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $convergence</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $message</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [1] "sd 0.154257212993837"</span></span>
<span><span class="co">## Length  Class   Mode </span></span>
<span><span class="co">##      1   mle2     S4</span></span></code></pre>
<p><img src="Aq_fitting_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The fitting returns a list of 3 objects. The first object corresponds
to the fitting using a minimum square function whereas the second object
corresponds to a maximum likelihood derived using the mle2 package. This
latter method is useful because it allows us to calculate the confidence
interval of the parameters.</p>
<p>The third object correspond to the mean environmental values present
in the input data file of the function (see the help of f.fitting for
more info).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fitting1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              2.5 %     97.5 %</span></span>
<span><span class="co">## sigma    0.1121193  0.2315494</span></span>
<span><span class="co">## JmaxRef 89.5922893 92.6655218</span></span>
<span><span class="co">## RdRef    0.9488200  1.2489213</span></span>
<span><span class="co">## Theta    0.6028079  0.7204107</span></span></code></pre>
<p>It is possible to compare the AIC of the two models using the base
function AIC or BIC. The lower AIC or BIC corresponds to the best model.
It shows in this case that adding VcmaxRef is not usefull.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fitting1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -7.963471</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fitting2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -6.574518</span></span></code></pre>
<p>We can redo this procedure for the second simulated curve:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitting3</span><span class="op">=</span><span class="fu"><a href="../reference/f.fitting.html">f.fitting</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures2</span>,Start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>JmaxRef <span class="op">=</span> <span class="fl">30</span>, RdRef <span class="op">=</span> <span class="fl">1</span>,Theta<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,param<span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>abso<span class="op">=</span><span class="fl">0.9</span>,VcmaxRef<span class="op">=</span><span class="fl">150</span><span class="op">)</span>,</span>
<span>                   modify.init<span class="op">=</span><span class="cn">TRUE</span>,do.plot<span class="op">=</span><span class="cn">TRUE</span>,type<span class="op">=</span><span class="st">'Aq'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $par</span></span>
<span><span class="co">##    JmaxRef      RdRef      Theta </span></span>
<span><span class="co">## 80.2918206  0.9357455  0.8066975 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $value</span></span>
<span><span class="co">## [1] 0.6441247</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">## function gradient </span></span>
<span><span class="co">##      132       NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $convergence</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $message</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [1] "sd 0.207223659568046"</span></span>
<span><span class="co">## Length  Class   Mode </span></span>
<span><span class="co">##      1   mle2     S4</span></span></code></pre>
<p><img src="Aq_fitting_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitting4</span><span class="op">=</span><span class="fu"><a href="../reference/f.fitting.html">f.fitting</a></span><span class="op">(</span>measures <span class="op">=</span> <span class="va">measures2</span>,Start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>JmaxRef <span class="op">=</span> <span class="fl">30</span>, RdRef <span class="op">=</span> <span class="fl">1</span>,Theta<span class="op">=</span><span class="fl">0.5</span>,VcmaxRef<span class="op">=</span><span class="fl">30</span><span class="op">)</span>,param<span class="op">=</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>abso<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                   modify.init<span class="op">=</span><span class="cn">TRUE</span>,do.plot<span class="op">=</span><span class="cn">TRUE</span>,type<span class="op">=</span><span class="st">'Aq'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $par</span></span>
<span><span class="co">##    JmaxRef      RdRef      Theta   VcmaxRef </span></span>
<span><span class="co">## 91.0102515  0.8282943  0.6501977 54.4861347 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $value</span></span>
<span><span class="co">## [1] 0.2620363</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $counts</span></span>
<span><span class="co">## function gradient </span></span>
<span><span class="co">##      299       NA </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $convergence</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $message</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [1] "sd 0.132170675027424"</span></span>
<span><span class="co">## Length  Class   Mode </span></span>
<span><span class="co">##      1   mle2     S4</span></span></code></pre>
<p><img src="Aq_fitting_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<p>As previously we can compare the fitting with or without VcmaxRef as
a parameter to estimate:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fitting3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.8946358</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fitting4</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -11.21021</span></span></code></pre>
<p>In this case, the model with VcmaxRef is better.</p>
<p>Generally it is interesting to test the fitting with or without
VcmaxRef, and sometimes with or without Theta. Note that Theta can be
difficult to estimate and can also reach negative values (June,
2005).</p>
<p>Note also that the parameters from the light curves (VcmaxRef and
JmaxRef notably) are rarely used in modeling and that the estimation of
those parameters is generally done using A-Ci curves.</p>
<p>June, T. (2005). The light gradients inside soybean leaves and their
effect on the curvature factor of the light response curves of
photosynthesis. BIOTROPIA-The Southeast Asian Journal of Tropical
Biology, (25).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julien Lamour.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
