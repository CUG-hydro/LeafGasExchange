<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guide to use the LeagGasExchange package to simulate leaf conductance • LeafGasExchange</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Guide to use the LeagGasExchange package to simulate leaf conductance">
<meta property="og:description" content="LeafGasExchange">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LeafGasExchange</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Aci_fitting.html">Aci_fitting</a>
    </li>
    <li>
      <a href="../articles/Aq_fitting.html">Aq_fitting</a>
    </li>
    <li>
      <a href="../articles/Canopy_scaling.html">Canopy_scaling</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_conductance.html">Guide to use the LeagGasExchange package to simulate leaf conductance</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_photosynthesis.html">Guide to use the LeafGasExchange package to simulate the photosynthesis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Guide to use the LeagGasExchange package to
simulate leaf conductance</h1>
                        <h4 data-toc-skip class="author">Julien
LAMOUR</h4>
            
            <h4 data-toc-skip class="date">04/20/2023</h4>
      
      
      <div class="hidden name"><code>Simulation_of_leaf_conductance.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="simulation-of-conductance-knowing-the-photosynthesis-rate">Simulation of conductance knowing the photosynthesis rate<a class="anchor" aria-label="anchor" href="#simulation-of-conductance-knowing-the-photosynthesis-rate"></a>
</h2>
<p>It is possible to simulate the leaf water stomatal conductance using
the function f.gs. The function allows to simulate different conductance
models: the one from Ball et al. (1987) noted “BWB”, the two versions
from Medlyn et al. (2011), i.e. the USO model “USO” and the
approximation of the USO model “USO_simpl” which is similar to
previously published empirical models (such as the BWB model). A new
version is also included which is nonlinear “Nonlinear”.</p>
<p>The “BWB” model (Ball et al. 1987) is:</p>
<div class="figure">
<embed src="https://latex.codecogs.com/gif.latex?g_%7Bsw%7D%3Dg_0+g_1*A_n*RH/CO_%7B2s%7D"></embed><p class="caption">equation</p>
</div>
<p>With g0 the intercept for A == 0, and g1 the slope parameter. RH
corresponds to the relative humidity and CO2s to the CO2 concentration
at the leaf surface.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span><span class="op">=</span><span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">20</span></span>
<span><span class="va">cs</span><span class="op">=</span><span class="fl">400</span></span>
<span><span class="va">RH</span><span class="op">=</span><span class="fl">70</span></span>
<span><span class="va">g0</span><span class="op">=</span><span class="fl">0.02</span></span>
<span><span class="va">g1_BWB</span><span class="op">=</span><span class="fl">6</span></span>
<span><span class="va">BWB_gs</span><span class="op">=</span><span class="fu"><a href="../reference/f.gs.html">f.gs</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>,cs <span class="op">=</span> <span class="va">cs</span>,RH <span class="op">=</span> <span class="va">RH</span>,g0 <span class="op">=</span> <span class="va">g0</span>,g1 <span class="op">=</span> <span class="va">g1_BWB</span>,model<span class="op">=</span><span class="st">'BWB'</span><span class="op">)</span></span></code></pre></div>
<p>The “USO” model (Medlyn et al. 2011) is:</p>
<div class="figure">
<img src="https://latex.codecogs.com/gif.image?%5Cdpi%7B110%7Dg_%7Bsw%7D=g_0+1.6(1+%5Cfrac%7Bg_1%7D%7BVPD_%7Bleaf%7D%5D%7D)(%5Cfrac%7BA_n%7D%7BCO_%7B2s%7D%7D)" alt=""><p class="caption">equation</p>
</div>
<p>It can be simplified in the “USO_simpl” model :</p>
<div class="figure">
<embed src="https://latex.codecogs.com/gif.latex?g_%7Bsw%7D%3Dg_0+1.6g_1%5Cfrac%7BA_n%7D%7BCO_%7B2s%7D%5Csqrt%7BVPD_%7Bleaf%7D%7D%7D"></embed><p class="caption">equation</p>
</div>
<p>Those models don’t use the relative humidity but the leaf to air
vapor pressure deficit (not clear in the paper, could also be the Air
vapor pressure deficit VPDA. In this model, the VPDleaf is used)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ds</span><span class="op">=</span><span class="fl">1000</span></span>
<span><span class="va">USO_gs</span><span class="op">=</span><span class="fu"><a href="../reference/f.gs.html">f.gs</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>,cs <span class="op">=</span> <span class="va">cs</span>,ds <span class="op">=</span> <span class="va">ds</span>,g0 <span class="op">=</span> <span class="va">g0</span>,g1 <span class="op">=</span> <span class="va">g1_BWB</span>,model<span class="op">=</span><span class="st">'USO'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">USO_simpl_gs</span><span class="op">=</span><span class="fu"><a href="../reference/f.gs.html">f.gs</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>,cs <span class="op">=</span> <span class="va">cs</span>,ds <span class="op">=</span> <span class="va">ds</span>,g0 <span class="op">=</span> <span class="va">g0</span>,g1 <span class="op">=</span> <span class="va">g1_BWB</span>,model<span class="op">=</span><span class="st">'USO_simpl'</span><span class="op">)</span></span></code></pre></div>
<p>Finally, a “Nonlinear” version of the USO_simpl conductance model is
also implemented, see our paper Lamour et al. (2022):</p>
<div class="figure">
<embed src="https://latex.codecogs.com/gif.latex?g_%7Bsw%7D%3Dg_0+1.6g_1%5Cfrac%7BA_g%5E2%7D%7BCO_%7B2s%7D%5Csqrt%7BVPD_%7Bleaf%7D%7D%7D"></embed><p class="caption">equation</p>
</div>
<p>Note that the gross assimilation (Ag = An + Rdark) is used instead of
the net assimilation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Rd</span><span class="op">=</span><span class="fl">2</span></span>
<span><span class="va">g1_Nonlinear</span><span class="op">=</span><span class="fl">0.23</span></span>
<span><span class="va">Nonlinear_gs</span><span class="op">=</span><span class="fu"><a href="../reference/f.gs.html">f.gs</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>,cs <span class="op">=</span> <span class="va">cs</span>,ds <span class="op">=</span> <span class="va">ds</span>,g0 <span class="op">=</span> <span class="va">g0</span>,g1 <span class="op">=</span> <span class="va">g1_Nonlinear</span>, Rd<span class="op">=</span><span class="va">Rd</span>,model<span class="op">=</span><span class="st">'Nonlinear'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimation-of-the-conductance-parameters-g0-and-g1-using-linear-regressions">Estimation of the conductance parameters g0 and g1 using linear
regressions<a class="anchor" aria-label="anchor" href="#estimation-of-the-conductance-parameters-g0-and-g1-using-linear-regressions"></a>
</h2>
<p>The parameters g0 and g1 of the 4 models can be estimated using
linear regressions:</p>
<div class="figure">
<embed src="https://latex.codecogs.com/gif.latex?Y%3Dg_0+g_1X+%5Cvarepsilon"></embed><p class="caption">equation</p>
</div>
<p>with Y the response variable, X the regressor and epsilon the
residual. For all the models except “USO” Y corresponds to the
conductance.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X_BWB</span><span class="op">=</span><span class="va">A</span><span class="op">*</span><span class="va">RH</span><span class="op">/</span><span class="fl">100</span><span class="op">/</span><span class="va">cs</span></span>
<span><span class="va">X_USO_simpl</span><span class="op">=</span><span class="fl">1.6</span><span class="op">*</span><span class="va">A</span><span class="op">/</span><span class="va">cs</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">ds</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">X_Nonlinear</span><span class="op">=</span><span class="fl">1.6</span><span class="op">*</span><span class="op">(</span><span class="va">A</span><span class="op">+</span><span class="va">Rd</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">ds</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span><span class="op">/</span><span class="va">cs</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">BWB_gs</span><span class="op">~</span><span class="va">X_BWB</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = BWB_gs ~ X_BWB)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## (Intercept)        X_BWB  </span></span>
<span><span class="co">##        0.02         6.00</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">USO_simpl_gs</span><span class="op">~</span><span class="va">X_USO_simpl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = USO_simpl_gs ~ X_USO_simpl)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## (Intercept)  X_USO_simpl  </span></span>
<span><span class="co">##        0.02         6.00</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Nonlinear_gs</span><span class="op">~</span><span class="va">X_Nonlinear</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Nonlinear_gs ~ X_Nonlinear)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## (Intercept)  X_Nonlinear  </span></span>
<span><span class="co">##        0.02         0.23</span></span></code></pre>
<p>In those examples you see that g0 and g1 were correctly estimated,
i.e. they were the same as the ones used to simulate the data.</p>
<p>For the non simplified USO model, a linear regression can also be
performed but with :</p>
<div class="figure">
<embed src="https://latex.codecogs.com/gif.latex?Y%3Dg_%7Bsw%7D-%5Cfrac%7B1.6A_n%7D%7BCO_%7B2s%7D%7D"></embed><p class="caption">equation</p>
</div>
<div class="figure">
<embed src="https://latex.codecogs.com/gif.latex?X%3D%5Cfrac%7B1.6A_n%7D%7B%5Csqrt%7BVPD_%7Bleaf%7D%7DCO_%7B2s%7D%7D"></embed><p class="caption">equation</p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y_USO</span><span class="op">=</span> <span class="va">USO_gs</span> <span class="op">-</span> <span class="fl">1.6</span> <span class="op">*</span> <span class="va">A</span><span class="op">/</span><span class="va">cs</span></span>
<span><span class="va">X_USO</span><span class="op">=</span><span class="va">X_USO_simpl</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y_USO</span><span class="op">~</span><span class="va">X_USO</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Y_USO ~ X_USO)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## (Intercept)        X_USO  </span></span>
<span><span class="co">##        0.02         6.00</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="simulation-of-conductance-using-a-coupled-photosynthesis---conductance-model">Simulation of conductance using a coupled photosynthesis -
conductance model<a class="anchor" aria-label="anchor" href="#simulation-of-conductance-using-a-coupled-photosynthesis---conductance-model"></a>
</h2>
<p>In the previous examples, the conductance was simulated using the
photosynthesis (An or Ag) as an input variable. However, in reality both
the conductance and the photosynthesis are linked and influence each
other. It is possible to simulate the photosynthesis and the conductance
together using the f.A function which simulates the leaf gas
exchange.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PFD</span><span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">2000</span></span>
<span><span class="va">USO_simulation</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">PFD</span>,cs <span class="op">=</span> <span class="fl">400</span>,Tleaf <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,Tair <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,RH <span class="op">=</span> <span class="fl">70</span>,param <span class="op">=</span> <span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>g0<span class="op">=</span><span class="fl">0.02</span>,g1<span class="op">=</span><span class="fl">3</span>,model.gs <span class="op">=</span> <span class="st">"USO"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">USO_simpl_simulation</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">PFD</span>,cs <span class="op">=</span> <span class="fl">400</span>,Tleaf <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,Tair <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,RH <span class="op">=</span> <span class="fl">70</span>,param <span class="op">=</span> <span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>g0<span class="op">=</span><span class="fl">0.02</span>,g1<span class="op">=</span><span class="fl">2.67</span>,model.gs <span class="op">=</span> <span class="st">"USO_simpl"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">BWB_simulation</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">PFD</span>,cs <span class="op">=</span> <span class="fl">400</span>,Tleaf <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,Tair <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,RH <span class="op">=</span> <span class="fl">70</span>,param <span class="op">=</span> <span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>g0<span class="op">=</span><span class="fl">0.02</span>,g1<span class="op">=</span><span class="fl">5</span>,model.gs <span class="op">=</span> <span class="st">"BWB"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Nonlinear_simulation</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="va">PFD</span>,cs <span class="op">=</span> <span class="fl">400</span>,Tleaf <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,Tair <span class="op">=</span> <span class="fl">25</span><span class="op">+</span><span class="fl">273.16</span>,RH <span class="op">=</span> <span class="fl">70</span>,param <span class="op">=</span> <span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>g0<span class="op">=</span><span class="fl">0.02</span>,g1<span class="op">=</span><span class="fl">0.23</span>,model.gs <span class="op">=</span> <span class="st">"Nonlinear"</span>,VcmaxRef<span class="op">=</span><span class="fl">55</span>,RdRef<span class="op">=</span><span class="fl">0.015</span><span class="op">*</span><span class="fl">55</span>,JmaxRef<span class="op">=</span><span class="fl">1.67</span><span class="op">*</span><span class="fl">55</span>,TpRef <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">USO_simulation</span><span class="op">$</span><span class="va">gs</span>,type<span class="op">=</span><span class="st">'l'</span>,ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Conductance</span><span class="op">~</span> <span class="va">mol</span><span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span><span class="op">~</span><span class="va">s</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="st">'lightblue'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">USO_simpl_simulation</span><span class="op">$</span><span class="va">gs</span>,col<span class="op">=</span><span class="st">'slateblue3'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">BWB_simulation</span><span class="op">$</span><span class="va">gs</span>,col<span class="op">=</span><span class="st">'orchid1'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">Nonlinear_simulation</span><span class="op">$</span><span class="va">gs</span>,col<span class="op">=</span><span class="st">'deeppink2'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'bottomright'</span>,col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lightblue'</span>,<span class="st">'slateblue3'</span>,<span class="st">'orchid1'</span>,<span class="st">'deeppink2'</span><span class="op">)</span>,lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USO"</span>,<span class="st">"USO_simpl"</span>,<span class="st">"BWB"</span>,<span class="st">"Nonlinear"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Simulation_of_leaf_conductance_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>The transpiration is also an output of the f.A function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">USO_simulation</span><span class="op">$</span><span class="va">Transp</span>,type<span class="op">=</span><span class="st">'l'</span>,ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Transpiration</span><span class="op">~</span> <span class="va">mL</span><span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="op">-</span><span class="fl">2</span><span class="op">~</span><span class="va">s</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="st">'lightblue'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">USO_simpl_simulation</span><span class="op">$</span><span class="va">Transp</span>,col<span class="op">=</span><span class="st">'slateblue3'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">BWB_simulation</span><span class="op">$</span><span class="va">Transp</span>,col<span class="op">=</span><span class="st">'orchid1'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PFD</span>,y<span class="op">=</span><span class="va">Nonlinear_simulation</span><span class="op">$</span><span class="va">Transp</span>,col<span class="op">=</span><span class="st">'deeppink2'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'bottomright'</span>,col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lightblue'</span>,<span class="st">'slateblue3'</span>,<span class="st">'orchid1'</span>,<span class="st">'deeppink2'</span><span class="op">)</span>,lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USO"</span>,<span class="st">"USO_simpl"</span>,<span class="st">"BWB"</span>,<span class="st">"Nonlinear"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Simulation_of_leaf_conductance_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Ball, J. T., Woodrow, I. E., &amp; Berry, J. A. (1987). A model
predicting stomatal conductance and its contribution to the control of
photosynthesis under different environmental conditions. In Progress in
photosynthesis research (pp. 221-224). Springer, Dordrecht.</p>
<p>Lamour, J., Davidson, K. J., Ely, K. S., Le Moguédec, G., Leakey, A.
D., Li, Q., Serbin, S. P., Rogers, A. (2022). An improved representation
of the relationship between photosynthesis and stomatal conductance
leads to more stable estimation of conductance parameters and improves
the goodness‐of‐fit across diverse data sets. Global change biology,
28(11), 3537-3556.</p>
<p>Medlyn, B.E., Duursma, R.A., Eamus, D., Ellsworth, D.S., Prentice,
I.C., Barton, C.V.M., Crous, K.Y., De Angelis, P., Freeman, M. and
Wingate, L. (2011), Reconciling the optimal and empirical approaches to
modelling stomatal conductance. Global Change Biology, 17:
2134-2144.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julien Lamour.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
