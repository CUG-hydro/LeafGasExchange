<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guide to use the LeafGasExchange package to simulate the photosynthesis • LeafGasExchange</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Guide to use the LeafGasExchange package to simulate the photosynthesis">
<meta property="og:description" content="LeafGasExchange">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LeafGasExchange</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Aci_fitting.html">Aci_fitting</a>
    </li>
    <li>
      <a href="../articles/Aq_fitting.html">Aq_fitting</a>
    </li>
    <li>
      <a href="../articles/Canopy_scaling.html">Canopy_scaling</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_conductance.html">Guide to use the LeagGasExchange package to simulate leaf conductance</a>
    </li>
    <li>
      <a href="../articles/Simulation_of_leaf_photosynthesis.html">Guide to use the LeafGasExchange package to simulate the photosynthesis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Guide to use the LeafGasExchange package to
simulate the photosynthesis</h1>
                        <h4 data-toc-skip class="author">Julien
LAMOUR</h4>
            
            <h4 data-toc-skip class="date">04/20/2023</h4>
      
      
      <div class="hidden name"><code>Simulation_of_leaf_photosynthesis.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="description-of-the-photosynthesis-model">Description of the photosynthesis model<a class="anchor" aria-label="anchor" href="#description-of-the-photosynthesis-model"></a>
</h2>
<p>The package LeafGasExchange can be used to simulate the
photosynthesis at the leaf level using the function f.AT(). The FvCB
photosynthesis model (Farquhar et al. 1980) is coupled with the USO
model (Medlyn et al. 2011) and an energy balance model (Muir 2019).</p>
<p>The input variables for this model are:</p>
<ul>
<li><p>Photosynthetic photon flux density, PFD in micro mol m-2
s-1</p></li>
<li><p>CO2 at the surface of the leaf, cs in ppm</p></li>
<li><p>Air temperature at the surface of the leaf, Tair in degree
K</p></li>
<li><p>Air relative humidity, RH in percent (between 0 and 100)</p></li>
<li><p>Wind speed at the surface of the leaf, wind in m s-1</p></li>
</ul>
<p>The parameters for this function are the parameters of the
photosynthesis and stomata models. The list of parameters is described
in the help of the function f.make.param. It includes notably the
parameters Vcmax, Jmax, Tp, Rd at 25 degree C and g0 and g1.</p>
<p>In addition to those parameters, the parameters precision and max_it
can be modified. By default their value are 0.1 degree C and 10,
respectively. To better understand, the energy budget is calculated
iteratively. Temperature convergence is achieved when the prior leaf
temperature which is guessed and the predicted temperature are within
the accuracy range given by the parameter ‘precision’ (default to 0.1
degree C). If more than max_it iterations are needed for the temperature
to converge, then the calculation stops. Both parameters can be changed
depending on the accuracy needed, the more the precision wanted, the
more iteration the calculation will need.</p>
<p>The output variables are:</p>
<ul>
<li><p>the net assimilation, A, in micro mol m-2 s-1</p></li>
<li><p>the rubisco limited assimilation rate, Ac, in micro mol m-2
s-1</p></li>
<li><p>the electron transport limited assimilation rate, Aj, in micro
mol m-2 s-1</p></li>
<li><p>the export limited assimilation rate, Ap, in micro mol m-2
s-1</p></li>
<li><p>the leaf water conductance, gs, in mol m-2 s-1</p></li>
<li><p>The CO2 concentration inside the stomata cavity, ci, in
ppm</p></li>
<li><p>The vapour pressure deficit between the leaf and the surounding
atmosphere, ds, in Pa</p></li>
<li><p>The transpiration rate of the leaf in g m-2 s-1</p></li>
<li><p>gbw, The boundary layer conductance in mol m-2 s-1.</p></li>
<li><p>cs, the CO2 concentration at the leaf surface in ppm.</p></li>
<li><p>RHs, the Relative humidity at the leaf surface (0 100).</p></li>
<li><p>Tleaf, the Leaf temperature in K</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation-of-the-package-from-github">Installation of the package from github<a class="anchor" aria-label="anchor" href="#installation-of-the-package-from-github"></a>
</h2>
<p>First, the package devtools is needed to install the package
LeafGasExchange from github. If you don’t have devtools you have to
first install it and load it.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span></code></pre></div>
<p>The LeafGasExchange package can then be downloaded, installed and
loaded using the folowing commands:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install_github</span><span class="op">(</span><span class="st">'https://github.com/TESTgroup-BNL/LeafGasExchange.git'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">LeafGasExchange</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: stats4</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: polynom</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: bbmle</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: readxl</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: stringr</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: tidyverse</span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.4</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.4.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.0</span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">slice()</span>  masks <span style="color: #0000BB;">bbmle</span>::slice()</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="co">## Loading required package: tealeaves</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Loading required package: units</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## udunits database from /usr/share/xml/udunits/udunits2.xml</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Loading required package: reshape2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'reshape2'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:tidyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     smiths</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="creation-of-a-list-of-parameters-used-by-the-f-at-function">Creation of a list of parameters used by the f.AT() function<a class="anchor" aria-label="anchor" href="#creation-of-a-list-of-parameters-used-by-the-f-at-function"></a>
</h2>
<p>The function f.make.param() can be used to create a list of
photosynthetic parameters. By default, the parameters are the one from
the Functionnaly Assembled Terrestrial Ecosystem Simulator for tropical
species.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">LeafGasExchange</span><span class="op">)</span></span>
<span><span class="va">param</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $R</span></span>
<span><span class="co">## [1] 8.314</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $O2</span></span>
<span><span class="co">## [1] 210</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TRef</span></span>
<span><span class="co">## [1] 298.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Patm</span></span>
<span><span class="co">## [1] 101</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxRef</span></span>
<span><span class="co">## [1] 83.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxHa</span></span>
<span><span class="co">## [1] 43540</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxHd</span></span>
<span><span class="co">## [1] 152040</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxS</span></span>
<span><span class="co">## [1] 495</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxRef</span></span>
<span><span class="co">## [1] 50</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxHa</span></span>
<span><span class="co">## [1] 65330</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxHd</span></span>
<span><span class="co">## [1] 149250</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxS</span></span>
<span><span class="co">## [1] 485</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpRef</span></span>
<span><span class="co">## [1] 8.333333</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpHa</span></span>
<span><span class="co">## [1] 53100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpHd</span></span>
<span><span class="co">## [1] 150650</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpS</span></span>
<span><span class="co">## [1] 490</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $thetacj</span></span>
<span><span class="co">## [1] 0.999</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $thetaip</span></span>
<span><span class="co">## [1] 0.999</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdRef</span></span>
<span><span class="co">## [1] 1.43</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdHa</span></span>
<span><span class="co">## [1] 46390</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdHd</span></span>
<span><span class="co">## [1] 150650</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdS</span></span>
<span><span class="co">## [1] 490</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KcRef</span></span>
<span><span class="co">## [1] 404.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KcHa</span></span>
<span><span class="co">## [1] 79430</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KoRef</span></span>
<span><span class="co">## [1] 278.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KoHa</span></span>
<span><span class="co">## [1] 36380</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $GstarRef</span></span>
<span><span class="co">## [1] 42.75</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $GstarHa</span></span>
<span><span class="co">## [1] 37830</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $abso</span></span>
<span><span class="co">## [1] 0.85</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $aQY</span></span>
<span><span class="co">## [1] 0.425</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Theta</span></span>
<span><span class="co">## [1] 0.7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $g0</span></span>
<span><span class="co">## [1] 0.02</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $g1</span></span>
<span><span class="co">## [1] 4.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model.gs</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $power</span></span>
<span><span class="co">## [1] 0.5</span></span></code></pre>
<p>It is possible to change some or all of the parameters by modifying
the parameters in the call of the function f.make.param(). An example is
given below where JmaxRef, VcmaxRef, RdRef and g0 and g1 are
modified.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/f.make.param.html">f.make.param</a></span><span class="op">(</span>JmaxRef <span class="op">=</span> <span class="fl">100</span>,VcmaxRef <span class="op">=</span> <span class="fl">60</span>,RdRef <span class="op">=</span> <span class="fl">1</span>,g0 <span class="op">=</span> <span class="fl">0.02</span>,g1<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $R</span></span>
<span><span class="co">## [1] 8.314</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $O2</span></span>
<span><span class="co">## [1] 210</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TRef</span></span>
<span><span class="co">## [1] 298.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Patm</span></span>
<span><span class="co">## [1] 101</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxRef</span></span>
<span><span class="co">## [1] 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxHa</span></span>
<span><span class="co">## [1] 43540</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxHd</span></span>
<span><span class="co">## [1] 152040</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $JmaxS</span></span>
<span><span class="co">## [1] 495</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxRef</span></span>
<span><span class="co">## [1] 60</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxHa</span></span>
<span><span class="co">## [1] 65330</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxHd</span></span>
<span><span class="co">## [1] 149250</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $VcmaxS</span></span>
<span><span class="co">## [1] 485</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpRef</span></span>
<span><span class="co">## [1] 8.333333</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpHa</span></span>
<span><span class="co">## [1] 53100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpHd</span></span>
<span><span class="co">## [1] 150650</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TpS</span></span>
<span><span class="co">## [1] 490</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $thetacj</span></span>
<span><span class="co">## [1] 0.999</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $thetaip</span></span>
<span><span class="co">## [1] 0.999</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdRef</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdHa</span></span>
<span><span class="co">## [1] 46390</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdHd</span></span>
<span><span class="co">## [1] 150650</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $RdS</span></span>
<span><span class="co">## [1] 490</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KcRef</span></span>
<span><span class="co">## [1] 404.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KcHa</span></span>
<span><span class="co">## [1] 79430</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KoRef</span></span>
<span><span class="co">## [1] 278.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $KoHa</span></span>
<span><span class="co">## [1] 36380</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $GstarRef</span></span>
<span><span class="co">## [1] 42.75</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $GstarHa</span></span>
<span><span class="co">## [1] 37830</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $abso</span></span>
<span><span class="co">## [1] 0.85</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $aQY</span></span>
<span><span class="co">## [1] 0.425</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Theta</span></span>
<span><span class="co">## [1] 0.7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $g0</span></span>
<span><span class="co">## [1] 0.02</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $g1</span></span>
<span><span class="co">## [1] 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $model.gs</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $power</span></span>
<span><span class="co">## [1] 0.5</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="predicting-the-photosynthesis">Predicting the photosynthesis<a class="anchor" aria-label="anchor" href="#predicting-the-photosynthesis"></a>
</h2>
<p>Prediction of the photosynthesis using the previous list of
parameters and different leaf conditions is done in the following
way:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Leaf_photo</span><span class="op">=</span><span class="fu"><a href="../reference/f.AT.html">f.AT</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="fl">1500</span>,ca <span class="op">=</span> <span class="fl">400</span>,Tair <span class="op">=</span> <span class="fl">273.15</span><span class="op">+</span><span class="fl">29</span>,RHa <span class="op">=</span> <span class="fl">70</span>,wind <span class="op">=</span> <span class="fl">2</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Leaf_photo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          A       Ac      Aj       Ap       Ag       Rd        gs       ci</span></span>
<span><span class="co">## 1 9.827052 9.887746 12.0333 27.37827 10.88575 1.058694 0.1638462 303.9644</span></span>
<span><span class="co">##         ds     Transp      gbw       cs     RHs    Tleaf</span></span>
<span><span class="co">## 1 2262.238 0.06605806 1.443636 390.6742 59.7955 306.3139</span></span></code></pre>
<p>In this case the leaf temperature was predicted by the function. If
the leaf temperature is known, it is possible to use the function
f.A</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Leaf_photo2</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="fl">1000</span>,cs <span class="op">=</span> <span class="fl">400</span>,Tair <span class="op">=</span> <span class="fl">273.15</span><span class="op">+</span><span class="fl">29</span>,Tleaf <span class="op">=</span> <span class="fl">303</span>,RH <span class="op">=</span> <span class="fl">70</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Leaf_photo2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $A</span></span>
<span><span class="co">## [1] 12.781</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Ac</span></span>
<span><span class="co">## [1] 13.00088</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Aj</span></span>
<span><span class="co">## [1] 13.72704</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Ap</span></span>
<span><span class="co">## [1] 27.62239</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Ag</span></span>
<span><span class="co">## [1] 13.88129</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Rd</span></span>
<span><span class="co">## [1] 1.100289</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $gs</span></span>
<span><span class="co">## [1] 0.2438359</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ci</span></span>
<span><span class="co">## [1] 316.0173</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ds</span></span>
<span><span class="co">## [1] 1401.926</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Transp</span></span>
<span><span class="co">## [1] 0.06092196</span></span></code></pre>
<p>The function f.A accepts vectors as input variables, so it is
possible to simulate a light curve or an CO2 curve easily:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Leaf_photo3</span><span class="op">=</span><span class="fu"><a href="../reference/f.A.html">f.A</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2000</span>,cs <span class="op">=</span> <span class="fl">400</span>,Tair <span class="op">=</span> <span class="fl">273.15</span><span class="op">+</span><span class="fl">29</span>,Tleaf <span class="op">=</span> <span class="fl">303</span>,RH <span class="op">=</span> <span class="fl">70</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">2000</span>,y <span class="op">=</span> <span class="va">Leaf_photo3</span><span class="op">$</span><span class="va">A</span>,xlab<span class="op">=</span><span class="st">'PFD'</span>,ylab<span class="op">=</span><span class="st">'Anet'</span>,type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Simulation_of_leaf_photosynthesis_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Similarly, it is possible to simulate a light curve by considering
the leaf energy budget. The simulation is more computational intensive
than without the energy budget. So it is important to reduce the number
of simulation cases. Here the light curve is simulated with a resolution
of 50 PFD between each point of the curve, instead of a resolution of 1
as done previously.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Leaf_photo4</span><span class="op">=</span><span class="fu"><a href="../reference/f.AT.html">f.AT</a></span><span class="op">(</span>PFD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2000</span>,<span class="fl">50</span><span class="op">)</span>,ca <span class="op">=</span> <span class="fl">400</span>,Tair <span class="op">=</span> <span class="fl">273.15</span><span class="op">+</span><span class="fl">29</span>,wind<span class="op">=</span><span class="fl">2</span>,RHa <span class="op">=</span> <span class="fl">80</span>,param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2000</span>,<span class="fl">50</span><span class="op">)</span>,y <span class="op">=</span> <span class="va">Leaf_photo4</span><span class="op">$</span><span class="va">A</span>,xlab<span class="op">=</span><span class="st">'PFD'</span>,ylab<span class="op">=</span><span class="st">'Anet'</span>,type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span></span></code></pre></div>
<p><img src="Simulation_of_leaf_photosynthesis_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Farquhar, G.D., von Caemmerer, S. &amp; Berry, J.A. A biochemical
model of photosynthetic CO2 assimilation in leaves of C3 species. Planta
149, 78–90 (1980).</p>
<p>Medlyn, B.E., Duursma, R.A., Eamus, D., Ellsworth, D.S., Prentice,
I.C., Barton, C.V.M., Crous, K.Y., De Angelis, P., Freeman, M. and
Wingate, L. (2011), Reconciling the optimal and empirical approaches to
modelling stomatal conductance. Global Change Biology, 17:
2134-2144.</p>
<p>Christopher D Muir, tealeaves: an R package for modelling leaf
temperature using energy budgets, AoB PLANTS, Volume 11, Issue 6,
December 2019, plz054</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julien Lamour.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
